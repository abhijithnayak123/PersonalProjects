<?xml version="1.0" encoding="utf-8" ?>
<objects xmlns="http://www.springframework.net"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:db="http://www.springframework.net/database"
         xmlns:tx="http://www.springframework.net/tx"
         xsi:schemaLocation="http://www.springframework.net http://www.springframework.net/xsd/spring-objects.xsd">

  <import resource="assembly://MGI.Biz.Partner/MGI.Biz.Partner/Biz.Partner.Services.Spring.xml"/>

  <object id="ThrowsBizReceiptExceptionAdvice" type="MGI.Biz.Receipt.Impl.Advice.ThrowsBizReceiptExceptionAdvice, MGI.Biz.Receipt"/>

  <object id="BIZReceiptRepo" type="MGI.Biz.Receipt.Impl.ReceiptTemplateRepo, MGI.Biz.Receipt">
      <constructor-arg index="0" value= "${ReceiptServerURL}"/>
      <constructor-arg index="1" value="${ReceiptServerDBName}" />
      <constructor-arg index="2" value="${ReceiptServerBucketName}" />
      <property name="NLogger" ref="NLoggerRef"></property>
  </object>

  <object id="BIZReceiptService" type="Spring.Aop.Framework.ProxyFactoryObject, Spring.Aop">
    <property name="Target" ref="InterceptedBIZReceipt"/>
    <property name="InterceptorNames">
      <list>
        <value>ThrowsBizReceiptExceptionAdvice</value>
      </list>
    </property>
  </object>
  
  <object id="InterceptedBIZReceipt" type="MGI.Biz.Receipt.Impl.ReceiptRouterImpl, MGI.Biz.Receipt" >
    <property name="BaseReceiptService" ref="BaseReceiptService" />
    <property name="ReceiptProcessorRouter" ref="ReceiptProcessorRouter" />
    <property name="ChannelPartnerSvc" ref="CorePartnerChannelPartnerService"/>
    <property name="PtnrCheckSvc" ref="PartnerCheckService"/>
    <property name="PtnrFundsSvc" ref="PartnerFundsService"/>
    <property name="PtnrBillPaySvc" ref="BillPayService"/>
    <property name="PtnrXferSvc" ref="PartnerMoneyTransferService"/>
    <property name="PtnrMOSvc" ref="PartnerMoneyOrderService"/>
  </object>

  <object id="BaseReceiptService" type="Spring.Aop.Framework.ProxyFactoryObject, Spring.Aop">
    <property name="Target" ref="InterceptedBaseReceiptService"/>
    <property name="InterceptorNames">
      <list>
        <value>ThrowsBizReceiptExceptionAdvice</value>
      </list>
    </property>
  </object>

 
  <object id="InterceptedBaseReceiptService" type="MGI.Biz.Receipt.Impl.BaseReceiptServiceImpl, MGI.Biz.Receipt" >
    <property name="ChannelPartnerSvc" ref="CorePartnerChannelPartnerService"/>
    <property name="PtnrBillPaySvc" ref="BillPayService"/>
    <property name="PtnrCheckSvc" ref="PartnerCheckService"/>
    <property name="PtnrFundsSvc" ref="PartnerFundsService"/>
    <property name="PtnrMOSvc" ref="PartnerMoneyOrderService"/>
    <property name="PtnrCashSvc" ref="CashService"/>
    <property name="PtnrXferSvc" ref="PartnerMoneyTransferService"/>
    <property name="ReceiptRepo" ref="BIZReceiptRepo"/>
    <property name="CustomerSessionService" ref="CustomerSessionService"/>
    <property name="CxeCustomerSvc" ref="CXECustomerService"/>
    <property name="ManageUserService" ref="BIZPartnerUserService"/>
    <property name="ProcessorSvc" ref="GPRProcessorRouter"/>
    <property name="MoneyTransferProcessorSvc" ref="MoneyTransferProcessorRouter" />
    <property name="CxeMoneyOrderSvc" ref="CXEMoneyOrderService"/>
    <property name="BillPayProcessorRouter" ref="BillPayProcessorRouter" />
    <property name="TimeZones" ref="TimeZonesAbbr"/>
    <property name="PtnrShoppingCartSvc" ref="InterceptedBIZPartnerShoppingCart" />
	<property name="PTNRFeeAdjustmentService" ref="FeeAdjustmentService"/>
	<property name="CheckProcessorRouter" ref="CheckProcessorRouter"/>
	<property name="MongoDBLogger" ref="TLoggerRef"/>
  </object>	

  <!--Receipt Processor Router Start-->
  <object id="ReceiptProcessorRouter" type="MGI.Cxn.Common.Processor.Util.ProcessorRouter, MGI.Cxn.Common">
    <property name="ParentProcessors">
      <object id="ReceiptProcessorsDictionary" type="System.Collections.Generic.Dictionary&lt;string, System.Collections.Generic.Dictionary&lt;string,MGI.Cxn.Common.Processor.Contract.IProcessor&gt;&gt;, mscorlib">
        <constructor-arg>
          <dictionary key-type="string" value-type="System.Collections.Generic.Dictionary&lt;string,MGI.Cxn.Common.Processor.Contract.IProcessor&gt;">
            <entry key="Synovus">
              <dictionary key-type="string" value-type="MGI.Cxn.Common.Processor.Contract.IProcessor">
                <!--WU Bill Pay-->
                <entry key="WesternUnionBillPay">
                  <ref object="BizWUReceiptService"/>
                </entry>
                <!--WU Money Transfer-->
                <entry key="WesternUnion">
                  <ref object="BizWUReceiptService"/>
                </entry>
              </dictionary>
            </entry>
            <entry key="Carver">
              <dictionary key-type="string" value-type="MGI.Cxn.Common.Processor.Contract.IProcessor">               
                <!--WU Bill Pay-->
                <entry key="WesternUnionBillPay">
                  <ref object="BizWUReceiptService"/>
                </entry>
                <!--WU Money Transfer-->
                <entry key="WesternUnion">
                  <ref object="BizWUReceiptService"/>
                </entry>
              </dictionary>
            </entry>
            <entry key="TCF">
              <dictionary key-type="string" value-type="MGI.Cxn.Common.Processor.Contract.IProcessor">
                <!--WU Bill Pay-->
                <entry key="WesternUnionBillPay">
                  <ref object="BizWUReceiptService"/>
                </entry>
                <!--WU Money Transfer-->
                <entry key="WesternUnion">
                  <ref object="BizWUReceiptService"/>
                </entry>
              </dictionary>
            </entry>
            <entry key="MGI">
              <dictionary key-type="string" value-type="MGI.Cxn.Common.Processor.Contract.IProcessor">
                <!--Money Transfer-->
                <entry key="MoneyGram">
                  <ref object="BizMoneyGramReceiptService"/>
                </entry>
                <!--Bill Pay-->
                <entry key="MoneyGramBillPay">
                  <ref object="BizMoneyGramReceiptService"/>
                </entry>
              </dictionary>
            </entry>
			  <entry key="Redstone">
				  <dictionary key-type="string" value-type="MGI.Cxn.Common.Processor.Contract.IProcessor">
					  <!--Money Transfer-->
					  <entry key="MoneyGram">
						  <ref object="BizMoneyGramReceiptService"/>
					  </entry>
					  <!--Bill Pay-->
					  <entry key="MoneyGramBillPay">
						  <ref object="BizMoneyGramReceiptService"/>
					  </entry>
				  </dictionary>
			  </entry>
          </dictionary>
        </constructor-arg>
      </object>
    </property>
  </object>
  <!--Receipt Processor Router End-->
	
  <!--Provider Specific Recipt Impl -->
  <object id="BizMoneyGramReceiptService" type="MGI.Biz.Receipt.Impl.MGIReceiptServiceImpl, MGI.Biz.Receipt"  parent="InterceptedBaseReceiptService">
  </object>

  <object id="BizWUReceiptService" type="MGI.Biz.Receipt.Impl.WUReceiptServiceImpl, MGI.Biz.Receipt" parent="InterceptedBaseReceiptService">
  </object>

  <!--Provider Specific Recipt Impl End-->

</objects>