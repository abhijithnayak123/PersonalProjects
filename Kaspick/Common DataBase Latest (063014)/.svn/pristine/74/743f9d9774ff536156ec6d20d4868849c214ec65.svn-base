IF EXISTS (
		SELECT *
		FROM sysobjects
		WHERE type = 'P'
			AND NAME = 'USP_EX_GetSysadminCgasetup'
		)
BEGIN
	DROP PROCEDURE USP_EX_GetSysadminCgasetup;

	PRINT 'DROPPED PROCEDURE USP_EX_GetSysadminCgasetup';
END
GO

SET QUOTED_IDENTIFIER ON
GO

/*********************************************************************************************************************                                                   
* New Procedure Name : USP_EX_GetSysadminCgasetup
* Old Procedure Name  : USP_EIS_EX_SYSADMIN_CGASETUP_SelProc         
* Description     :           
  
* Input Parameter :    
                                   
* Modification Log                                                       
*                                      
* Date       Modified By  Description                                                      
*--------------------------------------------------------------------------------------------------------------------                                                   
* 25-Jan-06  Venugopal.B  Created     
* 18-May-06  Venugopal B  Delete_Flag is removed   
* 8-Apr-14    Sanath       Req EXCREQ3.1 CGA Set up
* 22-MAY-2014 Mallikarjun   SP Name Renamed and Formatted             
*********************************************************************************************************************/
CREATE PROCEDURE [dbo].[USP_EX_GetSysadminCgasetup] (@SEARCH_CONDITION VARCHAR(100))
AS
BEGIN
	IF (@SEARCH_CONDITION = '')
	BEGIN
		SET @SEARCH_CONDITION = '%%'
	END

	SELECT SETUP_ID
		,LstItm.ABBREV AS STATE
		,ISNULL(LstItmCTyp.LISTITEMNAME, '') AS CGATYPE
		,ISNULL(LstItmResrv.LISTITEMNAME, '') AS RESERVE
		,ISNULL(ANNUAL_REPORTING_FORM_RULE, '') AS ANNUAL_REPORTING_FORM_RULE
		,ISNULL(ANNUAL_FINANCIAL_STATEMENT_RULE, '') AS ANNUAL_FINANCIAL_STATEMENT_RULE
		,ISNULL(WEBSITE_ADDRESS, '') AS WEBSITE_ADDRESS
	FROM TBL_BR_CGASetup CgaStp
	LEFT JOIN TBL_ListItem LstItm ON LstItm.ListItemID = CgaStp.STATE_TYPE_ID
	LEFT JOIN TBL_ListItem LstItmCTyp ON LstItmCTyp.LISTITEMID = CgaStp.CGATYPE_TYPE_ID
	LEFT JOIN TBL_LISTITEM LstItmResrv ON LstItmResrv.LISTITEMID = CgaStp.RESERVE_TYPE_ID
	WHERE LstItm.ABBREV LIKE '%' + @SEARCH_CONDITION + '%' --Search condition should be confirmed with vinay.        
	ORDER BY LstItm.ABBREV
END
GO

IF EXISTS (
		SELECT *
		FROM sysobjects
		WHERE type = 'P'
			AND NAME = 'USP_EX_GetSysadminCgasetup'
		)
BEGIN
	PRINT 'CREATED PROCEDURE USP_EX_GetSysadminCgasetup';
END