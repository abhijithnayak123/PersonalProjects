DELETE FROM TBL_POLICYITEM
WHERE POLICYDIMENSIONID IN (
		SELECT DISTINCT policydimensionid
		FROM TBL_PolicyDimension
		WHERE Fullname IN (
				'Client Name'
				,'TARP FCB Rollover'
				,'TARP Mkt Value Roll.'
				,'TARP Data Extract'
				,'Rpt Schedule'
				,'Mon Bene Rpt Prn set'
				,'Qtrly report copies'
				,'SAnn Ben Rpt Prnset'
				,'Ann Bene Rpt Copies'
				,'Ann Don Rpt Prn set'
				,'Mon Publish to Web'
				,'Qtr Publish to Web'
				,'SAnn Publish to Web'
				,'Ann Publish to Web'
				,'PIF Key Statistics'
				,'PIF Account History'
				,'PIF Unit Dec Prec'
				,'Payment Summary'
				,'Ann Acct History'
				,'Ann Alloc Summary'
				,'Ann Perf Summary'
				,'Per Perf Summary'
				,'Ann Portfolio App'
				,'Per Portfolio App'
				,'Cli Acct # on Rpts'
				,'Spigot Special Page'
				,'Min Req Dist (DAF)'
				,'Donor Advised Fund'
				,'Client Color Scheme'
				,'Client Logo'
				,'Client Contact'
				,'Mon DVD copies'
				,'Qtr DVD copies'
				,'SAnn DVD copies'
				,'No. of CD - Ann Rpt'
				,'Prior Period Adj'
				,'Custom label'
				,'TARP Prod. Cycle'
				,'TARP Calendar'
				,'CTS Production'
				,'Perf Net of Fees'
				,'Comp. Statistics Rpt'
				,'Exc from Rpt Medians'
				,'CTS Client Policy'
				,'PV Rpt by Acct Type'
				,'PV Rpt by Designatn'
				,'Retirement/Perpetual'
				,'Srt dt for perform.'
				,'Display Pmt Report'
				,'K-1 MAILING RULE'
				,'Trustee Change Date'
				,'Tax Return Ext. Date'
				,'Account Transfer Dt'
				,'Address Change Date'
				,'1099R Media'
				,'TX RTN MAILING RULE'
				,'MN State ID'
				,'Depre. Schedule'
				,'Mon Send To'
				,'Qtrly Send To'
				,'SAnn Send To'
				,'Ann Send To'
				,'Mon Client Recipient'
				,'Qtr Client Recipient'
				,'SA Client Recipient'
				,'Ann Client Recipient'
				,'Label Logo'
				,'Mon Perf Summary'
				,'SA Perf Summary'
				,'Mon Portfolio App'
				,'SA Portfolio App'
				,'PO Start Date'
				,'PO End Date'
				,'QAS Start Date'
				,'Fiscal Year End'
				)
		)

SET IDENTITY_INSERT TBL_PolicyItem ON

INSERT INTO TBL_PolicyItem (
	PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,OwnerId
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,ModifiedDate
	,ModifiedUserId
	,CreatedDate
	,CreatedUserId
	,DeletedUserId
	)
SELECT PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,clnt.BriefName
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,getdate()
	,1
	,getdate()
	,1
	,NULL
FROM Excelsior_DB8_5..PolicyItem PItem
INNER JOIN Excelsior_DB8_5..CLIENT clnt on clnt.ClientId = PItem.OwnerID AND PItem.PolicyLevel = 100
WHERE POLICYDIMENSIONID IN (
		SELECT DISTINCT policydimensionid
		FROM TBL_PolicyDimension
		WHERE Fullname IN (
				'Client Name'
				,'TARP FCB Rollover'
				,'TARP Mkt Value Roll.'
				,'TARP Data Extract'
				,'Rpt Schedule'
				,'Mon Bene Rpt Prn set'
				,'Qtrly report copies'
				,'SAnn Ben Rpt Prnset'
				,'Ann Bene Rpt Copies'
				,'Ann Don Rpt Prn set'
				,'Mon Publish to Web'
				,'Qtr Publish to Web'
				,'SAnn Publish to Web'
				,'Ann Publish to Web'
				,'PIF Key Statistics'
				,'PIF Account History'
				,'PIF Unit Dec Prec'
				,'Payment Summary'
				,'Ann Acct History'
				,'Ann Alloc Summary'
				,'Ann Perf Summary'
				,'Per Perf Summary'
				,'Ann Portfolio App'
				,'Per Portfolio App'
				,'Cli Acct # on Rpts'
				,'Spigot Special Page'
				,'Min Req Dist (DAF)'
				,'Donor Advised Fund'
				,'Client Color Scheme'
				,'Client Logo'
				,'Client Contact'
				,'Mon DVD copies'
				,'Qtr DVD copies'
				,'SAnn DVD copies'
				,'No. of CD - Ann Rpt'
				,'Prior Period Adj'
				,'Custom label'
				,'TARP Prod. Cycle'
				,'TARP Calendar'
				,'CTS Production'
				,'Perf Net of Fees'
				,'Comp. Statistics Rpt'
				,'Exc from Rpt Medians'
				,'CTS Client Policy'
				,'PV Rpt by Acct Type'
				,'PV Rpt by Designatn'
				,'Retirement/Perpetual'
				,'Srt dt for perform.'
				,'Display Pmt Report'
				,'K-1 MAILING RULE'
				,'Trustee Change Date'
				,'Tax Return Ext. Date'
				,'Account Transfer Dt'
				,'Address Change Date'
				,'1099R Media'
				,'TX RTN MAILING RULE'
				,'MN State ID'
				,'Depre. Schedule'
				,'Mon Send To'
				,'Qtrly Send To'
				,'SAnn Send To'
				,'Ann Send To'
				,'Mon Client Recipient'
				,'Qtr Client Recipient'
				,'SA Client Recipient'
				,'Ann Client Recipient'
				,'Label Logo'
				,'Mon Perf Summary'
				,'SA Perf Summary'
				,'Mon Portfolio App'
				,'SA Portfolio App'
				,'PO Start Date'
				,'PO End Date'
				,'QAS Start Date'
				,'Fiscal Year End'
				)
		)
	AND PolicyItemId NOT IN (
		SELECT DISTINCT policyitemid
		FROM tbl_policyitem
		)
		
INSERT INTO TBL_PolicyItem (
	PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,OwnerID
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,ModifiedDate
	,ModifiedUserId
	,CreatedDate
	,CreatedUserId
	,DeletedUserId
	)
SELECT PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,substring(pgm.BriefName,1,15)
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,getdate()
	,1
	,getdate()
	,1
	,NULL
FROM Excelsior_DB8_5..PolicyItem PItem
INNER JOIN Excelsior_DB8_5..Program pgm on pgm.ProgramID = PItem.OwnerID AND PItem.PolicyLevel = 200
WHERE POLICYDIMENSIONID IN (
		SELECT DISTINCT policydimensionid
		FROM TBL_PolicyDimension
		WHERE Fullname IN (
				'Client Name'
				,'TARP FCB Rollover'
				,'TARP Mkt Value Roll.'
				,'TARP Data Extract'
				,'Rpt Schedule'
				,'Mon Bene Rpt Prn set'
				,'Qtrly report copies'
				,'SAnn Ben Rpt Prnset'
				,'Ann Bene Rpt Copies'
				,'Ann Don Rpt Prn set'
				,'Mon Publish to Web'
				,'Qtr Publish to Web'
				,'SAnn Publish to Web'
				,'Ann Publish to Web'
				,'PIF Key Statistics'
				,'PIF Account History'
				,'PIF Unit Dec Prec'
				,'Payment Summary'
				,'Ann Acct History'
				,'Ann Alloc Summary'
				,'Ann Perf Summary'
				,'Per Perf Summary'
				,'Ann Portfolio App'
				,'Per Portfolio App'
				,'Cli Acct # on Rpts'
				,'Spigot Special Page'
				,'Min Req Dist (DAF)'
				,'Donor Advised Fund'
				,'Client Color Scheme'
				,'Client Logo'
				,'Client Contact'
				,'Mon DVD copies'
				,'Qtr DVD copies'
				,'SAnn DVD copies'
				,'No. of CD - Ann Rpt'
				,'Prior Period Adj'
				,'Custom label'
				,'TARP Prod. Cycle'
				,'TARP Calendar'
				,'CTS Production'
				,'Perf Net of Fees'
				,'Comp. Statistics Rpt'
				,'Exc from Rpt Medians'
				,'CTS Client Policy'
				,'PV Rpt by Acct Type'
				,'PV Rpt by Designatn'
				,'Retirement/Perpetual'
				,'Srt dt for perform.'
				,'Display Pmt Report'
				,'K-1 MAILING RULE'
				,'Trustee Change Date'
				,'Tax Return Ext. Date'
				,'Account Transfer Dt'
				,'Address Change Date'
				,'1099R Media'
				,'TX RTN MAILING RULE'
				,'MN State ID'
				,'Depre. Schedule'
				,'Mon Send To'
				,'Qtrly Send To'
				,'SAnn Send To'
				,'Ann Send To'
				,'Mon Client Recipient'
				,'Qtr Client Recipient'
				,'SA Client Recipient'
				,'Ann Client Recipient'
				,'Label Logo'
				,'Mon Perf Summary'
				,'SA Perf Summary'
				,'Mon Portfolio App'
				,'SA Portfolio App'
				,'PO Start Date'
				,'PO End Date'
				,'QAS Start Date'
				,'Fiscal Year End'
				)
		)
	AND PolicyItemId NOT IN (
		SELECT DISTINCT policyitemid
		FROM tbl_policyitem
		)
		
INSERT INTO TBL_PolicyItem (
	PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,OwnerID
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,ModifiedDate
	,ModifiedUserId
	,CreatedDate
	,CreatedUserId
	,DeletedUserId
	)
SELECT PolicyItemId
	,PolicyDimensionId
	,PolicyLevel
	,acc.ADVENTID
	,NumericValue
	,TextValue
	,LogicalValue
	,DateValue
	,PolicyDropdownId
	,Comment
	,getdate()
	,1
	,getdate()
	,1
	,NULL
FROM Excelsior_DB8_5..PolicyItem PItem
INNER JOIN Excelsior_DB8_5..V_EIS_EX_ACCOUNT acc on acc.ACCOUNTID = PItem.OwnerID AND PItem.PolicyLevel = 300
WHERE POLICYDIMENSIONID IN (
		SELECT DISTINCT policydimensionid
		FROM TBL_PolicyDimension
		WHERE Fullname IN (
				'Client Name'
				,'TARP FCB Rollover'
				,'TARP Mkt Value Roll.'
				,'TARP Data Extract'
				,'Rpt Schedule'
				,'Mon Bene Rpt Prn set'
				,'Qtrly report copies'
				,'SAnn Ben Rpt Prnset'
				,'Ann Bene Rpt Copies'
				,'Ann Don Rpt Prn set'
				,'Mon Publish to Web'
				,'Qtr Publish to Web'
				,'SAnn Publish to Web'
				,'Ann Publish to Web'
				,'PIF Key Statistics'
				,'PIF Account History'
				,'PIF Unit Dec Prec'
				,'Payment Summary'
				,'Ann Acct History'
				,'Ann Alloc Summary'
				,'Ann Perf Summary'
				,'Per Perf Summary'
				,'Ann Portfolio App'
				,'Per Portfolio App'
				,'Cli Acct # on Rpts'
				,'Spigot Special Page'
				,'Min Req Dist (DAF)'
				,'Donor Advised Fund'
				,'Client Color Scheme'
				,'Client Logo'
				,'Client Contact'
				,'Mon DVD copies'
				,'Qtr DVD copies'
				,'SAnn DVD copies'
				,'No. of CD - Ann Rpt'
				,'Prior Period Adj'
				,'Custom label'
				,'TARP Prod. Cycle'
				,'TARP Calendar'
				,'CTS Production'
				,'Perf Net of Fees'
				,'Comp. Statistics Rpt'
				,'Exc from Rpt Medians'
				,'CTS Client Policy'
				,'PV Rpt by Acct Type'
				,'PV Rpt by Designatn'
				,'Retirement/Perpetual'
				,'Srt dt for perform.'
				,'Display Pmt Report'
				,'K-1 MAILING RULE'
				,'Trustee Change Date'
				,'Tax Return Ext. Date'
				,'Account Transfer Dt'
				,'Address Change Date'
				,'1099R Media'
				,'TX RTN MAILING RULE'
				,'MN State ID'
				,'Depre. Schedule'
				,'Mon Send To'
				,'Qtrly Send To'
				,'SAnn Send To'
				,'Ann Send To'
				,'Mon Client Recipient'
				,'Qtr Client Recipient'
				,'SA Client Recipient'
				,'Ann Client Recipient'
				,'Label Logo'
				,'Mon Perf Summary'
				,'SA Perf Summary'
				,'Mon Portfolio App'
				,'SA Portfolio App'
				,'PO Start Date'
				,'PO End Date'
				,'QAS Start Date'
				,'Fiscal Year End'
				)
		)
	AND PolicyItemId NOT IN (
		SELECT DISTINCT policyitemid
		FROM tbl_policyitem
		)
SET IDENTITY_INSERT TBL_PolicyItem OFF