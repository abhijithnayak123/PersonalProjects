IF EXISTS (SELECT *
           FROM   sysobjects 
           WHERE  type = 'P'
                  AND name = 'USP_EX_GetProfilePfaDtl')
    BEGIN
        DROP PROCEDURE USP_EX_GetProfilePfaDtl;
        PRINT 'DROPPED USP_EX_GetProfilePfaDtl';
    END
GO
    
    
 /**************************************************************************    
* PROCEDURE NAME  : USP_EX_GetProfilePfaDtl  
* OLD PROCEDURE NAME  : USP_EX_GetProfilePfaDtl    
* DESCRIPTION     : TO LIST OUT PFA DETAILS BASED ON PFA_ID    
* MODIFICATION LOG:     
*                                
* DATE         MODIFIED BY  DESCRIPTION                                                
*-------------------------------------------------------------------------    
* 25-OCT-06    VENUGOPAL B  CREATED        
* 18-APR-07    VENUGOPAL B      MODIFIED TO CONSIDER PAGENAME, FLD_NAME FOR REQUIRED LATER FIELD.   
* 18-APR-14    Sanath          CGA registartion tab in program module of req no EXCREQ6.4   
  
** 22-MAY-2014 Mallikarjun     SP Name Renamed and Formatted  
****************************************************************************/    
CREATE PROCEDURE [dbo].[USP_EX_GetProfilePfaDtl]     
 @ENTITY_TYPE VARCHAR(50),    
 @ENTITY_ID VARCHAR(15),     
 @PFA_ID INT,    
    @PAGENAME  VARCHAR(50)=NULL,    
 @FLD_NAME  VARCHAR(50)=NULL    
AS    
BEGIN    
  DECLARE @STATUSFLAG BIT     
     DECLARE @ENTITY_TYPE_ID INT    
    DECLARE @REQUIRED_LATER_DATE_PFA DATETIME    
    -- DECLARE @REQUIRED_LATER_ID_PFA INT    
    
  EXEC USP_EX_GetLISTITEMID
  @LIST_TYPE_NAME = 'ENTITY',    
  @LIST_ITEM_NAME = @ENTITY_TYPE,    
  @LIST_ITEM_ID = @ENTITY_TYPE_ID OUTPUT    
    
 IF (@STATUSFLAG = 1)    
 BEGIN     
  RAISERROR  50002 'RECORD DELETED'       
  RETURN      
    END    
    
  SELECT STATE_TYPE_ID,FILING_STATUS_TYPE_ID,ISNULL(FORM_DUE_DATE,'') AS FORM_DUE_DATE,ISNULL(@REQUIRED_LATER_DATE_PFA,'') AS REQUIRED_LATER_DATE      
  FROM TBL_EX_ProfilePFA PrflPfa    
  INNER JOIN TBL_BR_CGASetup CgaStp ON PrflPfa.CGA_SETUP_ID =CgaStp.SETUP_ID    
  WHERE PrflPfa.PFA_ID=@PFA_ID    
 --END    
    
END  

GO
  IF EXISTS (	SELECT *
			FROM sysobjects
			WHERE type = 'P'
			AND name = 'USP_EX_GetProfilePfaDtl') 
	BEGIN
			PRINT 'CREATED PROCEDURE USP_EX_GetProfilePfaDtl';
	END    