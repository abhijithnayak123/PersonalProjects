/****** Object:  StoredProcedure [dbo].[USP_PP_InsArchBeneficiaryPayment]    Script Date: 05/22/2013 11:19:33 ******/
IF EXISTS (
		SELECT *
		FROM sys.objects
		WHERE object_id = OBJECT_ID(N'[dbo].[USP_PP_InsArchBeneficiaryPayment]')
			AND type IN (
				N'P'
				,N'PC'
				)
		)
	DROP PROCEDURE [dbo].[USP_PP_InsArchBeneficiaryPayment]
GO

/****** Object:  StoredProcedure [dbo].[USP_PP_InsArchBeneficiaryPayment]    Script Date: 05/22/2013 11:19:33 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

/******************************************************************************                      
** Name:     USP_PP_InsArchBeneficiaryPayment                      
** Short Desc: Insert all values into TBL_PP_ARCH_BeneficiaryPayment from TBL_PP_STG_BeneficiaryPayment 
**                      
** Full Description: Insert all values into TBL_PP_ARCH_BeneficiaryPayment from TBL_PP_STG_BeneficiaryPayment         
**                              
** Input Arguments:   
**         
** Sample Call     
        
 EXEC USP_PP_InsArchBeneficiaryPayment     
**             
**                      
**                      
** Standard declarations                      
**       SET LOCK_TIMEOUT         30000   -- 30 seconds                      
**                       
** Created By: Debajyoti kalita   
** Company   : Kaspick & Company                      
** Project   : BackOffice Integration                      
** Created DT: 22-May-13                 
**                                  
*******************************************************************************                
**       Change History                      
*******************************************************************************                
** Date:      Author:	 Bug #     Description:                           
** --------  --------	 ------    -------------------------------------- 
** 05/06/2014  Salih               Modified the SP for the column Change from ExpenseCode to TaxCode
***
*******************************************************************************                      
** Copyright (C) <CopyrightYear,,Year> Kaspick & Company, All Rights Reserved                      
** COMPANY CONFIDENTIAL -- NOT FOR DISTRIBUTION                      
*******************************************************************************/
CREATE PROCEDURE [dbo].[USP_PP_InsArchBeneficiaryPayment]
AS
SET NOCOUNT ON

INSERT INTO TBL_PP_ARCH_BeneficiaryPayment (
	PaymentID
	,ContactID
	,CustomerAccountNumber
	,ContactRoleCode
	,InstructionID
	,DocumentNumber
	,TransactionNumber
	,AccountType
	,ManagerCode
	,PaymentDate
	,TaxYear
	,PayeeName
	,PayeeAddress
	,PaymentAmount
	,SourceBankName
	,SourceBankAddress
	,SourceBankABA
	,FractionalRoutingCode
	,PayorName
	,PayorAddress
	,SourceAccount
	,DestBankName
	,DestBankAddress
	,DestBankABA
	,DestAccount
	,Memo
	,VoidDate
	,ReissueOf
	,ReissueAs
	,DestAccountType
	--05/06/2014  Salih: Modified the SP for the column Change from ExpenseCode to TaxCode
	,TaxCode
	,ClearDate
	,ClearMethod
	,ChargeType
	,MailingAddress
	,SeparateCheck
	,SeparateCheckAddress
	,AllianceNumber
	,GiftAccountName
	,GSOInfo
	,PrintAdvice
	,PaymentMethod
	,PaymentFreq
	,PaidforContactID
	,PaymentStatus
	,ProcessedByMiddleWare
	,ProcessDateMiddleWare
	,IsPrintedOnCheck
	,PrintedDates
	,IsDeleted
	,ModifiedBy
	,ModifiedDate
	,CreatedBy
	,CreatedDate
	)
SELECT PaymentID
	,ContactID
	,CustomerAccountNumber
	,ContactRoleCode
	,InstructionID
	,DocumentNumber
	,TransactionNumber
	,AccountType
	,ManagerCode
	,PaymentDate
	,TaxYear
	,PayeeName
	,PayeeAddress
	,PaymentAmount
	,SourceBankName
	,SourceBankAddress
	,SourceBankABA
	,FractionalRoutingCode
	,PayorName
	,PayorAddress
	,SourceAccount
	,DestBankName
	,DestBankAddress
	,DestBankABA
	,DestAccount
	,Memo
	,VoidDate
	,ReissueOf
	,ReissueAs
	,DestAccountType
	--05/06/2014  Salih: Modified the SP for the column Change from ExpenseCode to TaxCode
	,TaxCode
	,ClearDate
	,ClearMethod
	,ChargeType
	,MailingAddress
	,SeparateCheck
	,SeparateCheckAddress
	,AllianceNumber
	,GiftAccountName
	,GSOInfo
	,PrintAdvice
	,PaymentMethod
	,PaymentFreq
	,PaidforContactID
	,'P' AS PaymentStatus
	,1 AS ProcessedByMiddleWare
	,CreatedDate AS ProcessedDateMiddleWare
	,1 AS IsPrintedOnCheck
	,CreatedDate AS PrintedDates
	,0 AS IsDeleted
	,ModifiedBy
	,ModifiedDate
	,CreatedBy
	,CreatedDate
FROM dbo.TBL_PP_STG_BeneficiaryPayment
GO


