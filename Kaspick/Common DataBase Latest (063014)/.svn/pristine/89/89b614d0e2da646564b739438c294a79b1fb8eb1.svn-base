
IF EXISTS (SELECT *
           FROM   sysobjects 
           WHERE  type = 'P'
                  AND name = 'USP_RP_GetListFrequency')
    BEGIN
        DROP PROCEDURE USP_RP_GetListFrequency;
        PRINT 'DROPPED USP_RP_GetListFrequency';
    END
GO


  
  
/******************************************************************************   
  
** New SP Name : [USP_RP_GetListFrequency]   
                         
** Name:     USP_EIS_DT_List_Frequency            
               
**          
** Short Desc:           
**          
** Full Description:           
**                                    
** Input Arguments:           
**               
** Sample Call           
 EXEC [USP_EX_ListFrequency] 0         
**                   
** Return values: Return Status          
**                            
** Standard declarations                            
**                             
** Created By: Soorya        
**          
** Company   : Kaspick & Company                            
** Project   : Deliverable Tool          
** Created DT: 12-Oct-2011                      
**                                        
*******************************************************************************                      
**       Change History                            
*******************************************************************************                      
** Date:        Author:  Bug #     Description:                           Rvwd                      
** --------  -------- ------    -------------------------------------- --------      
  
** 19-MAY-2014   RAJ    Modify with New Name of SP ExcelsiorDB into KaspickDB     
** 09-06-2014    RAJ	SP Name Renamed and Formatted             
          
*******************************************************************************                            
** Copyright (C) <CopyrightYear,,Year> Kaspick & Company, All Rights Reserved                            
** COMPANY CONFIDENTIAL -- NOT FOR DISTRIBUTION                            
*******************************************************************************/          
CREATE PROCEDURE [dbo].[USP_RP_GetListFrequency]    
(    
 @DeliverableID BIGINT = 0    
)          
AS     
BEGIN    
 IF (@DeliverableID = 0) -- All         
 BEGIN          
  SELECT     
   LI.LISTITEMID AS DDVALUE,     
   DDTEXT = (      
      CASE         
       WHEN RTRIM(LTRIM(LI.ListItemName)) = 'Annually' THEN 'Annual'        
       WHEN RTRIM(LTRIM(LI.ListItemName)) = 'Semi-Annually' THEN 'Semi-Annual'        
       ELSE RTRIM(LTRIM(LI.ListItemName))        
      END        
       )    
  FROM TBL_ListItem LI    
   INNER JOIN TBL_ListType LT ON LT.ListTypeID = LI.ListTypeID    
  WHERE LT.ListTypeName = 'Annual Frequency'    
  ORDER BY LI.LISTITEMID ASC     
 END    
 ELSE    
 BEGIN          
  SELECT     
   LI.ListItemID AS DDVALUE,     
   DDTEXT = (      
      CASE         
       WHEN RTRIM(LTRIM(LI.ListItemName)) = 'Annually' THEN 'Annual'        
       WHEN RTRIM(LTRIM(LI.ListItemName)) = 'Semi-Annually' THEN 'Semi-Annual'        
       ELSE RTRIM(LTRIM(LI.ListItemName))        
      END        
       )    
  FROM TBL_DLV_DeliverableFrequency DF     
   INNER JOIN TBL_ListItem LI ON LI.ListItemID = DF.FrequencyID    
   INNER JOIN TBL_ListType LT ON LT.ListTypeID = LI.ListTypeID    
  WHERE LT.ListTypeName = 'Annual Frequency' AND DF.DeliverableID = @DeliverableID    
  ORDER BY LI.ListItemID ASC     
 END           
END 





GO
  IF EXISTS (	SELECT *
			FROM sysobjects
			WHERE type = 'P'
			AND name = 'USP_RP_GetListFrequency') 
	BEGIN
			PRINT 'CREATED PROCEDURE USP_RP_GetListFrequency';
	END