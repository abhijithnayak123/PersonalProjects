IF EXISTS (
		SELECT *
		FROM sysobjects
		WHERE type = 'P'
			AND NAME = 'USP_EX_GetUserLoginName'
		)
BEGIN
	DROP PROCEDURE USP_EX_GetUserLoginName;

	PRINT 'DROPPED PROCEDURE USP_EX_GetUserLoginName';
END
GO

SET QUOTED_IDENTIFIER ON
GO

/******************************************************************************
** New Name :USP_EX_GetUserLoginName
** Old Name: [TBL_EIS_USER_LOGIN_NAMESelProc]
** Short Desc:	
**
** Full Description : This SP is used to get the USER_ID from TBL_EIS_USER table based  
**              on the LOGIN_NAME which is passed as parameter  and it returns
**               -1 if LOGIN_NAME does not exists.
**       
** Return values: 
**
**
** Standard declarations
**       SET NOCOUNT             ON
**       SET LOCK_TIMEOUT         30000   -- 30 seconds
**	
**	Created By: 
**	Company	  :	Kaspick & Company
**	Project	  :	Excelsior
**	Created DT:	
**            
*******************************************************************************
**       Change History
*******************************************************************************
** Date:        Author:  Bug #     Description:                           Rvwd
** --------     -------- ------    -------------------------------------- --------
** 20-Feb-2014   Mallikarjun     EXCREQ 7.4 Modified
** 23-MAY-2014   Mallikarjun     SP Name Renamed and Formatted
*******************************************************************************
** Copyright (C) <CopyrightYear,,Year> Kaspick & Company, All Rights Reserved
** COMPANY CONFIDENTIAL -- NOT FOR DISTRIBUTION
*******************************************************************************/
CREATE PROCEDURE [dbo].[USP_EX_GetUserLoginName] (@LOGIN_NAME AS VARCHAR(50))
AS
BEGIN
	IF EXISTS (
			SELECT USERID
			FROM TBL_KS_USER
			WHERE LOGINNAME = @LOGIN_NAME
				AND ISACTIVE = 1
			)
	BEGIN
		SELECT USERID
		FROM TBL_KS_USER
		WHERE LOGINNAME = @LOGIN_NAME
	END
	ELSE IF EXISTS (
			SELECT USERID
			FROM TBL_KS_USER
			WHERE LOGINNAME = @LOGIN_NAME
				AND ISACTIVE = 0
			)
	BEGIN
		SELECT - 1 USERID
	END
	ELSE
		SELECT 0 USERID
END
GO

IF EXISTS (
		SELECT *
		FROM sysobjects
		WHERE type = 'P'
			AND NAME = 'USP_EX_GetUserLoginName'
		)
BEGIN
	PRINT 'CREATED PROCEDURE USP_EX_GetUserLoginName';
END
GO

