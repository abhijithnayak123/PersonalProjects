
IF EXISTS (SELECT *
           FROM   sysobjects 
           WHERE  type = 'P'
                  AND name = 'USP_EX_SavePolicyReporting')
    BEGIN
        DROP PROCEDURE USP_EX_SavePolicyReporting;
        PRINT 'DROPPED USP_EX_SavePolicyReporting';
    END
GO

SET QUOTED_IDENTIFIER ON
GO 

/******************************************************************************        
** Name : USP_EX_SavePolicyReporting  
** Name:     USP_EIS_EX_POLICY_REPORTING_InsUpdProc         
** Short Desc: Put in Short Description        
**        
** Full Description        
**                
**        
** Sample Call        
        EXEC USP_EIS_EX_POLICY_REPORTING_InsUpdProc          
**        
** Return values: NONE        
**        
**        
** Standard declarations        
**       SET LOCK_TIMEOUT         30000   -- 30 seconds        
**         
** Created By: VShivhare        
** Company   : Kaspick & Company        
** Project   : Excelsior        
** Created DT: 05/18/2007        
**                    
*******************************************************************************        
**       Change History        
*******************************************************************************        
** Date:        Author:  Bug #     Description:                           Rvwd        
** --------     -------- ------    -------------------------------------- --------        
   05/18/2007 Vshivhare               
** 06/05/2009 Saravanan P Muthu KCO-BeneReport Project Enhancement        
   08/06/2009 Saravanan P Muthu KCBP - Quickbase CR #4 - Bene Report performance inception date change request (Move the field to the Reporting tab on the Beneficiary Report page)      
   09/04/2009 Saravanan PM  ET 10272 - Removed Client Logo Policy Cascading functionality        
   09/04/2009 Saravanan PM  ET 10272 - Added Client Logo Policy Cascading functionality        
   04/09/2014 Mallikarjun - Modified for Requirement EXCREQ 5.4  
   23/05/2014 Mallikarjun SP Name Rename and Formatted  
*******************************************************************************        
** Copyright (C) <CopyrightYear,,Year> Kaspick & Company, All Rights Reserved        
** COMPANY CONFIDENTIAL -- NOT FOR DISTRIBUTION        
  
EXEC USP_EX_SavePolicyReporting   
NULL,'ACCOUNT','352L418',0,0,1079,1097,1097,0,1075,0,0,0,19,19,19,  
1741,0,0,0,0,0,0,0,0,0,0,0,0,0,18,19,18,19,18,19,18,19,0,19,19,19,19,19,0,2,0,  
NULL,NULL,NULL,  
'<CONDITIONS><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Client Note</REPORTTYPE><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID><
/STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></AC
COUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEF
ICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PRO
GRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>235</FREQUEN
CYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special In
structions</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTIT
YTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STA
TUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><
COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICI
ARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCO
UNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></
CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special Instructions</REP
ORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</
ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITI
ON><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMM
ENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFIC
IARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</A
CCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID></CLIENTID><PROGR
AMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION></CONDITIONS>',  
NULL,'Beneficiary Reports',100048,NULL,1795,1795,1795,1796,0,0,0,0,18,18,18,18,NULL,NULL,NULL,2005  
  
-- For Account  
  
EXEC USP_EX_SavePolicyReporting   
NULL,'ACCOUNT','ACPIF1',0,0,1079,1097,1097,0,1075,0,0,0,19,19,19,  
1741,0,0,0,1,1,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,0,19,19,19,18,18,0,2,0,  
NULL,NULL,NULL,  
'<CONDITIONS><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Client Note</REPORTTYPE><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID><
/STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></AC
COUNTTYPE><COMMENTS>Test1</COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><
BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID>
</PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>235</FR
EQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Speci
al Instructions</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS>Test2</COMMENTS><STATUSID></STATUSID></CONDITION><CONDIT
ION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS>Test3</COMMENTS><S
TATUSID>18</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE>
</ACCOUNTTYPE><COMMENTS>Test4</COMMENTS><STATUSID>18</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1<
/ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID></CLIENTID><PROGRAM
ID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>242</FREQ
UENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Speci
al Instructions</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><
ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19
</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTT
YPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BEN
EFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID></CLIENTID><PROGRAMID></PROGRAMID>
<ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Account</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENT
ID></CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID>ACPIF1</ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION></CONDITIONS>'  
  
,NULL,'Beneficiary Reports',100048,'4/16/2014',1796,1796,1796,1795,0,0,0,0,19,19,19,19,NULL,NULL,NULL,2004  
  
-- For Client  
  
USP_EX_SavePolicyReporting   
NULL,'MANAGER','ACL',19,1098,1079,1097,1098,18,1075,1072,1071,1066,18,18,18,  
1741,0,0,0,1,0,0,0,0,1,0,0,0,1,18,18,18,18,18,18,19,18,19,18,18,18,18,18,2,1,1743,  
NULL,NULL,NULL,  
'<CONDITIONS><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Client Note</REPORTTYPE><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Mailing Insert</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>621</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>242</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>241</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Special Instructions</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID></STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Error</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION><CONDITION><ENTITYTYPE>Manager</ENTITYTYPE><REPORTTYPE>Warning</REPORTTYPE><FREQUENCYID>235</FREQUENCYID><CLIENTID>ACL</CLIENTID><PROGRAMID></PROGRAMID><ACCOUNTID></ACCOUNTID><BENEFICIARYID></BENEFICIARYID><ACCOUNTTYPE></ACCOUNTTYPE><COMMENTS></COMMENTS><STATUSID>19</STATUSID></CONDITION></CONDITIONS>',  
'<INDICESMANAGEMENTS><INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="1" IndexID="14"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="2" IndexID="13"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="3" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="4" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="5" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="6" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="7" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="8" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="9" IndexID="0"/> <INDMGMT VersionNo="1" MultiAssetBM="1" IndexNo="10" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="1" IndexID="8"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="2" IndexID="9"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="3" IndexID="7"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="4" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="5" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="6" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="7" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="8" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="9" IndexID="0"/> <INDMGMT VersionNo="2" MultiAssetBM="0" IndexNo="10" IndexID="0"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="1" IndexID="14"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="2" IndexID="11"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="3" IndexID="2"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="4" IndexID="3"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="5" IndexID="4"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="6" IndexID="10"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="7" IndexID="15"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="8" IndexID="13"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="9" IndexID="0"/> <INDMGMT VersionNo="3" MultiAssetBM="0" IndexNo="10" IndexID="0"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="1" IndexID="14"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="2" IndexID="10"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="3" IndexID="15"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="4" IndexID="5"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="5" IndexID="13"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="6" IndexID="6"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="7" IndexID="12"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="8" IndexID="1"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="9" IndexID="0"/> <INDMGMT VersionNo="4" MultiAssetBM="0" IndexNo="10" IndexID="0"/> </INDICESMANAGEMENTS>',  
'Beneficiary Reports',200003,NULL,1796,1796,1796,1795,0,0,0,0,18,18,18,19,NULL,NULL,NULL,1955    
  
  
*******************************************************************************/      
  
CREATE PROCEDURE [dbo].[USP_EX_SavePolicyReporting]      
(          
@CLIENTNAMEFORREPORTS VARCHAR(100)  
,@ENTITYTYPE VARCHAR(20)   
,@ENTITYID CHAR(15)    
,@EXCLUDEFROMMEDIANS INT  
,@COMPARATIVESTATISTICSREPORT INT  
,@RETIREMENTPERPETUAL INT  
,@PVBYDESIGNATION INT  
,@PVBYACCOUNTTYPE INT  
,@PERFNETOFFEES INT  
,@CTSVERSION INT  
,@CTSCLIENTVERSIONS INT  
,@TARPCALENDAR INT  
,@TARPPRODUCTIONCYCLE INT  
,@TARPEXCELDATAEXTRACT INT  
,@TARPMARKETVALUEROLLOVER INT  
,@TARPCOSTBASISROLLOVER INT  
,@REPORTSCHEDULE INT  
,@MONTHLYBENEREPORTCOPIES INT  
,@QUARTLYBENEREPORTCOPIES INT  
,@SEMIANNUALBENEREPORTCOPIES INT  
,@ANNUALBENEREPORTCOPIES INT  
,@ANNUALDONORREPORTCOPIES INT  
,@MONTHLYDVDREPORTCOPIES INT  
,@QUARTLYDVDREPORTCOPIES INT  
,@SEMIANNUALDVDREPORTCOPIES INT  
,@ANNUALDVDREPORTCOPIES INT  
,@MONTHLYWEBPUPBLISH BIT  
,@QUARTLYWEBPUPBLISH BIT  
,@SEMIANNUALWEBPUPBLISH BIT  
,@ANNUALWEBPUPBLISH BIT  
,@PAYMENTSUMMARY INT  
,@ACCOUNTHISTORY INT  
,@ASSETALLOCATIONSUMMARY INT  
,@PERFORMANCESUMMARY INT  
,@PERFORMANCESUMMARYPERIODIC INT  
,@PORTFOLIOAPPRAISAL INT  
,@PORTFOLIOAPPRAISALPERIODIC INT  
,@DISPLAYCLIENTACCOUNTNUMBER INT  
,@PRIORPERIODADJUSTMENT INT  
,@SPIGOTSPECIALPAGE INT  
,@MINREQDISTRIBUTION INT  
,@DAFSPECIALPAGE INT  
,@PIFKEYSTATISTICS INT  
,@PIFACCOUNTHISTORY INT  
,@PIFUINTDECIMAL INT  
,@CLIENTCOLORSCHEME INT  
,@CUSTOMLABEL INT  
,@CLIENTLOGOPATH VARCHAR(100)  
,@LABELLOGOPATH VARCHAR(100)  
,@CLIENTCONTACTINFO VARCHAR(100)  
,@CondtionXML XML  
,@IndicesMgmtXML XML = NULL  
,@REPORTCATEGORY VARCHAR(50)  
,@USERID INT  
,@PERFORMANCESTARTDATE DATETIME  
,@MONTHLYSENDTO INT  
,@QUARTLYSENDTO INT  
,@SEMIANNUALSENDTO INT  
,@ANNUALSENDTO INT  
,@MONTHLYCLIENTRECIPIENT INT  
,@QUARTLYCLIENTRECIPIENT INT  
,@SEMIANNUALCLIENTRECIPIENT INT  
,@ANNUALCLIENTRECIPIENT INT  
,@PERFORMANCESUMMARYMONTHLY INT  
,@PERFORMANCESUMMARYSEMIANNUAL INT  
,@PORTFOLIOAPPRAISALMONTHLY INT  
,@PORTFOLIOAPPRAISALSEMIANNUAL INT  
,@POSTARTDATE DATETIME  
,@POENDDATE DATETIME  
,@QASSTARTDATE DATETIME  
,@DISPLAYPAYMENTSONREPORT INT   
    
)          
AS             
BEGIN          
 BEGIN TRY        
 BEGIN TRAN       
     
 --concurrency code       
 DECLARE @STATUSFLAG BIT         
 DECLARE @LOCAL_TABLE_NAME VARCHAR(100)        
 DECLARE @LOCAL_FIELD_NAME VARCHAR(100)        
      
 IF @ENTITYTYPE='ACCOUNT'        
 BEGIN        
 SET @LOCAL_TABLE_NAME  = 'TBL_INV_ACCOUNTPROFILE'        
 SET @LOCAL_FIELD_NAME  = 'CustomerAccountNumber'      
    
   EXEC USP_EX_GetDeleteStatusFlag         
 @TABLE_NAME  = @LOCAL_TABLE_NAME,        
 @FIELD_NAME  = @LOCAL_FIELD_NAME,        
 @FIELD_VALUE = @ENTITYID,        
 @STATUS   = @STATUSFLAG OUTPUT     
    
        
  IF(@STATUSFLAG = 1)        
  BEGIN        
   RAISERROR  50002 'PARENT RECORD DELETED'         
   --ROLLBACK TRAN         
  END     
     
 END      
  
      
 IF(@STATUSFLAG = 1)        
 BEGIN        
  RAISERROR  50002 'PARENT RECORD DELETED'         
  --ROLLBACK TRAN         
 END       
   
        
 DECLARE @POLICY_LEVEL INT        
 SELECT @POLICY_LEVEL=POLICYLEVEL FROM TBL_POLICYLEVEL WHERE LEVELNAME=@ENTITYTYPE        
 DECLARE @CLIENTID VARCHAR(15), @ACCOUNT_TYPE VARCHAR(100)      
    
 IF(@ENTITYTYPE='ACCOUNT')      
 BEGIN      
  SELECT @CLIENTID=CLIENTID, @ACCOUNT_TYPE = ACCOUNTTYPE FROM VW_EX_Account WHERE ACCOUNTID=@ENTITYID      
 END     
  
    
 --For Client Name         
 IF(@CLIENTNAMEFORREPORTS='' OR @CLIENTNAMEFORREPORTS IS NULL)      
 BEGIN      
  SELECT @CLIENTNAMEFORREPORTS=TEXTVALUE FROM TBL_POLICYITEM WHERE      
  POLICYLEVEL=100 AND OWNERID=@CLIENTID AND POLICYDIMENSIONID=(SELECT POLICYDIMENSIONID      
  FROM TBL_POLICYDIMENSION WHERE FULLNAME='Client Name')      
  IF(@CLIENTNAMEFORREPORTS IS NULL)      
   SET @CLIENTNAMEFORREPORTS=NULL      
 END      
      
--Client Name       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Client Name',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @CLIENTNAMEFORREPORTS,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
  
      
--TARP Cost Basis Rollover        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'TARP FCB Rollover',        
  @LIST_ITEM_ID = @TARPCOSTBASISROLLOVER,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @TARPCOSTBASISROLLOVER,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For TARP Market Value Rollover        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'TARP Mkt Value Roll.',        
  @LIST_ITEM_ID = @TARPMARKETVALUEROLLOVER,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @TARPMARKETVALUEROLLOVER,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
        
--For TARP Excel Data Extract        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'TARP Data Extract',        
  @LIST_ITEM_ID = @TARPEXCELDATAEXTRACT,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @TARPEXCELDATAEXTRACT,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Report Schedule        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Rpt Schedule',        
  @LIST_ITEM_ID = @REPORTSCHEDULE ,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Monthly Beneficiary Copies        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Bene Rpt Prn set',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @MONTHLYBENEREPORTCOPIES,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Quartly Beneficiary Copies        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Qtrly report copies',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @QUARTLYBENEREPORTCOPIES,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Semi-Annual Beneficiary Copies        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SAnn Ben Rpt Prnset',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @SEMIANNUALBENEREPORTCOPIES,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Annual Beneficiary Copies        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Bene Rpt Copies',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @ANNUALBENEREPORTCOPIES,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Annual Donor Copies        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Don Rpt Prn set',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @ANNUALDONORREPORTCOPIES,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
 DECLARE @LISTITEMID INT      
      
--For Monthly Publish to Web        
 SELECT @LISTITEMID =dbo.Fn_GetListItemID(@MONTHLYWEBPUPBLISH,'Logical Value')      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Publish to Web',        
  @LIST_ITEM_ID = @LISTITEMID,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Quarlty Publish to Web        
 SET @LISTITEMID = NULL      
 SELECT @LISTITEMID =dbo.FN_GetListItemID(@QUARTLYWEBPUPBLISH,'Logical Value')      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Qtr Publish to Web',        
  @LIST_ITEM_ID = @LISTITEMID,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Semi-Annual Publish to Web        
 SET @LISTITEMID = NULL      
 SELECT @LISTITEMID =dbo.FN_GetListItemID(@SEMIANNUALWEBPUPBLISH,'Logical Value')      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SAnn Publish to Web',        
  @LIST_ITEM_ID = @LISTITEMID,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Annual Publish to Web        
 SET @LISTITEMID = NULL      
 SELECT @LISTITEMID =dbo.FN_GetListItemID(@ANNUALWEBPUPBLISH,'Logical Value')      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Publish to Web',        
  @LIST_ITEM_ID = @LISTITEMID,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
      
 IF( @ENTITYTYPE='MANAGER' OR (@ENTITYTYPE='ACCOUNT' AND @ACCOUNT_TYPE= 'PIF'))      
 BEGIN    
   
 --For PIF Key Statistics        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'PIF Key Statistics',        
   @LIST_ITEM_ID = @PIFKEYSTATISTICS,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = NULL,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For PIF Account History        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'PIF Account History',        
   @LIST_ITEM_ID = @PIFACCOUNTHISTORY,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = NULL,      
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For PIF Unit Decimal Precision        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'PIF Unit Dec Prec',        
   @LIST_ITEM_ID = NULL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @PIFUINTDECIMAL,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
 END      
      
--For Payment Summary       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Payment Summary',        
  @LIST_ITEM_ID = @PAYMENTSUMMARY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Account History        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Acct History',        
  @LIST_ITEM_ID = @ACCOUNTHISTORY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Asset Allocation Summary        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Alloc Summary',        
  @LIST_ITEM_ID = @ASSETALLOCATIONSUMMARY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Performance Summary        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Perf Summary',        
  @LIST_ITEM_ID = @PERFORMANCESUMMARY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Performance Summary Periodic       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Per Perf Summary',        
  @LIST_ITEM_ID = @PERFORMANCESUMMARYPERIODIC,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Portfolio Appraisal        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Portfolio App',        
  @LIST_ITEM_ID = @PORTFOLIOAPPRAISAL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @PORTFOLIOAPPRAISAL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Portfolio Appraisal Periodic      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Per Portfolio App',        
  @LIST_ITEM_ID = @PORTFOLIOAPPRAISALPERIODIC,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Display Client Account Number        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Cli Acct # on Rpts',        
  @LIST_ITEM_ID = @DISPLAYCLIENTACCOUNTNUMBER,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Spigot Special Page        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Spigot Special Page',        
  @LIST_ITEM_ID = @SPIGOTSPECIALPAGE,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
      
--For Minimum Required Distribution DAF       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Min Req Dist (DAF)',        
  @LIST_ITEM_ID = @MINREQDISTRIBUTION,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Donor Advised Fund Special Page        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Donor Advised Fund',        
  @LIST_ITEM_ID = @DAFSPECIALPAGE,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Client Color Scheme ( Numeric value)      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Client Color Scheme',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @CLIENTCOLORSCHEME,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Client Logo Path (URL)      
-- ET 10272 - Start here        
  EXEC USP_EX_SavePolicyitem          
   @POLICYDIMENSIONNAME = 'Client Logo',          
   @LIST_ITEM_ID = NULL,          
   @POLICYLEVEL = @POLICY_LEVEL,          
   @OWNERID = @ENTITYID,          
   @SCALARVALUE = @CLIENTLOGOPATH,          
   @POLICYCATEGORY='REPORTING NON OTHER',          
   @USERID=@USERID          
      
--For Client Contact Info      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Client Contact',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @CLIENTCONTACTINFO,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
 IF(@ENTITYTYPE='MANAGER')        
    BEGIN        
 --For Monthly  No. of DVD Copies        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Mon DVD copies',        
   @LIST_ITEM_ID = NULL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @MONTHLYDVDREPORTCOPIES,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Quartly No. of DVD Copies        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Qtr DVD copies',        
   @LIST_ITEM_ID = NULL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @QUARTLYDVDREPORTCOPIES,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Semi-Annual No. of DVD Copies        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'SAnn DVD copies',        
   @LIST_ITEM_ID = NULL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @SEMIANNUALDVDREPORTCOPIES,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Annual No. of DVD Copies        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'No. of CD - Ann Rpt',        
   @LIST_ITEM_ID = NULL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @ANNUALDVDREPORTCOPIES,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID       
      
 --For Prior Period Adjustment        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Prior Period Adj',        
   @LIST_ITEM_ID = @PRIORPERIODADJUSTMENT,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = NULL,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Client Custom Label        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Custom label',        
   @LIST_ITEM_ID = @CUSTOMLABEL,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = NULL,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For TARP Production Cycle        
  EXEC USP_EX_SavePolicyitem      
   @POLICYDIMENSIONNAME = 'TARP Prod. Cycle',        
   @LIST_ITEM_ID = @TARPPRODUCTIONCYCLE,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @TARPPRODUCTIONCYCLE,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
          
 --For TARP Calendar        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'TARP Calendar',        
   @LIST_ITEM_ID = @TARPCALENDAR,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @TARPCALENDAR,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
        
       
       
 --For CTS Production      
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'CTS Production',        
   @LIST_ITEM_ID = @CTSCLIENTVERSIONS,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @CTSCLIENTVERSIONS,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Perf Net of Fees        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Perf Net of Fees',        
   @LIST_ITEM_ID = @PERFNETOFFEES,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @PERFNETOFFEES,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
      
 --For Comparative Statistics Report         
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Comp. Statistics Rpt',        
   @LIST_ITEM_ID = @COMPARATIVESTATISTICSREPORT,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @COMPARATIVESTATISTICSREPORT,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
       
 --For Exclude from Medians        
  EXEC USP_EX_SavePolicyitem        
   @POLICYDIMENSIONNAME = 'Exc from Rpt Medians',        
   @LIST_ITEM_ID = @EXCLUDEFROMMEDIANS,        
   @POLICYLEVEL = @POLICY_LEVEL,        
   @OWNERID = @ENTITYID,        
   @SCALARVALUE = @EXCLUDEFROMMEDIANS,        
   @POLICYCATEGORY='REPORTING NON OTHER',        
   @USERID=@USERID        
     
 --For Indices Management       
  EXEC USP_EX_SaveRptReportIndicesManagement
   @USERID = @USERID ,       
   @CLIENTID = @ENTITYID,      
   @IndicesMgmtXML = @IndicesMgmtXML      
     
 END        
      
--For CTS Versions        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'CTS Client Policy',        
  @LIST_ITEM_ID = @CTSVERSION,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @CTSVERSION,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For PV by Account Type        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'PV Rpt by Acct Type',        
  @LIST_ITEM_ID = @PVBYACCOUNTTYPE,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @PVBYACCOUNTTYPE,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For PV by Designation        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'PV Rpt by Designatn',        
  @LIST_ITEM_ID =@PVBYDESIGNATION,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @PVBYDESIGNATION,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Retirement/Perpetual        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Retirement/Perpetual',        
  @LIST_ITEM_ID = @RETIREMENTPERPETUAL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @RETIREMENTPERPETUAL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
         
 /******************Insert Profile Reporting Conditions ****/      
 EXEC USP_EX_SaveRptReportCondition
   @CondtionXML= @CondtionXML,      
   @ENTITY_TYPE = @ENTITYTYPE,      
   @USERID  =  @USERID      
      
--KCBP - Quickbase CR #4 - Start here         
--For Performance StartDate                          
   EXEC USP_EX_SavePolicyitem                                
    @POLICYDIMENSIONNAME = 'Srt dt for perform.',                                
    @LIST_ITEM_ID = NULL,                                
    @POLICYLEVEL = @POLICY_LEVEL,                                
    @OWNERID = @ENTITYID,                                
    @SCALARVALUE = @PERFORMANCESTARTDATE,                    
    @POLICYCATEGORY = 'REPORTING NON OTHER',        
    @USERID = @USERID                             
--KCBP - Quickbase CR #4  - End here      
      
--For Monthly Send To      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Send To',        
  @LIST_ITEM_ID = @MONTHLYSENDTO,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Quartly Send To       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Qtrly Send To',        
  @LIST_ITEM_ID = @QUARTLYSENDTO,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Semi-Annual Send To       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SAnn Send To',        
  @LIST_ITEM_ID = @SEMIANNUALSENDTO,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Annual Send To        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Send To',        
  @LIST_ITEM_ID = @ANNUALSENDTO,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID     
    
--For Monthly Client Recipient     
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Client Recipient',        
  @LIST_ITEM_ID = NULL ,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @MONTHLYCLIENTRECIPIENT,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
    
--For Quartly Client Recipient       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Qtr Client Recipient',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @QUARTLYCLIENTRECIPIENT,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
    
--For Semi-Annual Client Recipient       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SA Client Recipient',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @SEMIANNUALCLIENTRECIPIENT,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Annual Client Recipient        
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Ann Client Recipient',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @ANNUALCLIENTRECIPIENT,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID     
    
--For Label Logo       
  EXEC USP_EX_SavePolicyitem              
   @POLICYDIMENSIONNAME = 'Label Logo',              
   @LIST_ITEM_ID = NULL,              
   @POLICYLEVEL = @POLICY_LEVEL,              
   @OWNERID = @ENTITYID,              
   @SCALARVALUE = @LABELLOGOPATH,              
   @POLICYCATEGORY='REPORTING NON OTHER',              
   @USERID=@USERID     
    
--For Performance Summary Monthly      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Perf Summary',        
  @LIST_ITEM_ID = @PERFORMANCESUMMARYMONTHLY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Performance Summary Semi Annual       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SA Perf Summary',        
  @LIST_ITEM_ID = @PERFORMANCESUMMARYSEMIANNUAL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Portfolio Appraisal Monthly       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'Mon Portfolio App',        
  @LIST_ITEM_ID = @PORTFOLIOAPPRAISALMONTHLY,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID        
      
--For Portfolio Appraisal Semi Annual       
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'SA Portfolio App',        
  @LIST_ITEM_ID = @PORTFOLIOAPPRAISALSEMIANNUAL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = NULL,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID       
    
-- Onsite: Added by Tanuj on 12/03/2010 for Program Overview    
--For PO Start Date      
 EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'PO Start Date',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @POSTARTDATE,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID     
    
--For PO End Date    
EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'PO End Date',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @POENDDATE,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID     
    
--For QAS End Date    
EXEC USP_EX_SavePolicyitem        
  @POLICYDIMENSIONNAME = 'QAS Start Date',        
  @LIST_ITEM_ID = NULL,        
  @POLICYLEVEL = @POLICY_LEVEL,        
  @OWNERID = @ENTITYID,        
  @SCALARVALUE = @QASSTARTDATE,        
  @POLICYCATEGORY='REPORTING NON OTHER',        
  @USERID=@USERID     
     
EXEC USP_EX_SavePolicyitem   
 @POLICYDIMENSIONNAME = 'Display Pmt Report'  
 ,@LIST_ITEM_ID = @DISPLAYPAYMENTSONREPORT  
 ,@POLICYLEVEL = @POLICY_LEVEL  
 ,@OWNERID = @ENTITYID  
 ,@SCALARVALUE = NULL  
 ,@POLICYCATEGORY = 'REPORTING NON OTHER'  
 ,@USERID = @USERID    
       
 COMMIT TRAN       
           
 END TRY          
 BEGIN CATCH       
   
  ROLLBACK TRAN        
  
  --IF (@@ERROR = 50002)        
		-- BEGIN      
		--  RAISERROR  50002 'PARENT RECORD DELETED'      
		--END      
  --ELSE If (@@ERROR = 1000092)  
		--BEGIN      
		--   RAISERROR  1000092 'USP_EX_SavePolicyReporting: CANNOT UPDATE REPORTING POLICIES IN TBL_POLICYITEM TABLE'        
		--END      
  --ElSE  
		--BEGIN  
		  DECLARE @ProcName VARCHAR(60);  
		  DECLARE @ErrorMessage NVARCHAR(4000);  
		  DECLARE @ErrorSeverity INT;  
		  DECLARE @ErrorState INT;  
		  
		  SET @ProcName = 'USP_EX_SavePolicyReporting';  
		  
		  SELECT @ErrorMessage = ERROR_MESSAGE()  
		   ,@ErrorSeverity = ERROR_SEVERITY()  
		   ,@ErrorState = ERROR_STATE();  
		   
		   RAISERROR (
								@ErrorMessage
								,-- Message text.
								@ErrorSeverity
								,-- Severity.
								@ErrorState -- State.
								);
		-- END  
    
 END CATCH          
END    
  
  
GO
  IF EXISTS (	SELECT *
			FROM sysobjects
			WHERE type = 'P'
			AND name = 'USP_EX_SavePolicyReporting') 
	BEGIN
			PRINT 'CREATED PROCEDURE USP_EX_SavePolicyReporting';
	END