<div class="tab-container">
    <app-spinner [show]="show"></app-spinner>
    <div id="binLocationFilter" class="binLocationFilter clearfix">
      <form class="row custForm no-gutters border-bottom custLayout">
        <div class="col col-auto">
          <div class="form-group row custFormrow">
            <label for="staticEmail" class="col-form-label font-bold width-90-1 minWidthAuto">Vendor</label>
            <kendo-combobox class="k-widget k-dropdown k-header width-250" [data]="VendorsList | unique"  [(value)]="selectedVendor"
              [placeholder]="'Select Vendor'" [popupSettings]="{ width: 'auto' }"
              [filterable]="true" (valueChange)="onVendorChange(selectedVendor)" (filterChange)="handleVendorFilter($event)">
            </kendo-combobox>
          </div>
          <div class="form-group row custFormrow">
            <label for="staticEmail" class="col-form-label font-bold widthAuto minWidthAuto">Pickup Location</label>
            <kendo-combobox class="k-widget k-dropdown k-header width-250" [data]="PickupList | unique" [(value)]="selectedPickup"
              [placeholder]="'Select Location'" [popupSettings]="{ width: 'auto' }" 
              [filterable]="true" (valueChange)="onLocationChange(selectedPickup)" (filterChange)="handlelocationFilter($event)">
            </kendo-combobox>
          </div>
        </div>
        <div class="col col-auto">
          <div class="form-group row custFormrow">
            <label for="staticEmail" class="col-form-label font-bold width-80-1 minWidthAuto">PO #</label>
            <kendo-combobox class="k-widget k-dropdown k-header width-150" [data]="PoList " [(value)]="selectedPONbr" 
            [textField]="'PONbr'" [valueField]="'PONbr'"
            [popupSettings]="{ width: 'auto' }" [placeholder]="'Select PO'" (valueChange)="onPOChange(selectedPONbr)" [filterable]="true" (filterChange)="handlePoNumbrFilter($event)">
            <ng-template kendoComboBoxHeaderTemplate>
              <div class="row k-list-header">
                <div class="col col-auto width-60 font-bold">PO #</div>
                <div class="col col-auto minWidth-100 font-bold">Created Date</div>
              </div>
           </ng-template>
           <ng-template kendoComboBoxItemTemplate let-dataItem>
              <div class="col col-auto width-60 templatecell">{{dataItem?.PONbr}}</div>
              <div class="col col-auto minWidth-100 templatecell">{{ dataItem?.OrderDate | date: 'MM/dd/yyyy hh:mm:ss a'}}</div>
             </ng-template>
            </kendo-combobox>
          </div>
          <div class="form-group row custFormrow">
            <label for="staticEmail" class="col-form-label font-bold width-80-1 minWidthAuto">Aramark Item</label>
            <kendo-combobox class="k-widget k-dropdown k-header width-150" [data]="AramarkList" [(value)]="selectedItemNbr"
            [textField]="'AramarkItemCode'" [valueField]="'AramarkItemCode'"
            [placeholder]="'Select Item'" [popupSettings]="{ width: 'auto' }" (valueChange)="onAramarkChange(selectedItemNbr)" [filterable]="true" (filterChange)="handleAramItemFilter($event)">
            <ng-template kendoComboBoxHeaderTemplate>
              <div class="row k-list-header">
                <div class="col col-auto width-100 font-bold">Aramark Item</div>
                <div class="col col-auto minWidth-100 font-bold">Description</div>
              </div>
           </ng-template>
           <ng-template kendoComboBoxItemTemplate let-dataItem>
              <div class="col col-auto width-100 templatecell">{{dataItem?.AramarkItemCode}}</div>
              <div class="col col-auto minWidth-100 templatecell">{{ dataItem?.AramarkDescription}}</div>
             </ng-template>
            </kendo-combobox>
          </div>
        </div>
        <div class="col col-auto">
          <div class="form-group row custFormrow ">
            <label for="staticEmail" class="col-form-label font-bold width-80-1 minWidthAuto">PO From Date</label>
            <div class="custFields  custFields-lg">
              <div class="input-group">
                <kendo-datepicker [(value)]="selectedFromDate" class="width-100"  placeholder="mm/dd/yyyy" [format]="'MM/dd/yyyy'"
                  (valueChange)="OnPOFromChange(selectedFromDate)"></kendo-datepicker>
              </div>
            </div>
          </div>
  
          <div class="form-group row custFormrow">
            <label for="staticEmail" class="col-form-label font-bold width-80-1 minWidthAuto">PO Status</label>
            <kendo-dropdownlist class="width-100" [data]="PoStatus | unique" [(value)]="selectedPOStatus" 
              [popupSettings]="{ width: 'auto' }" (valueChange)="onStatusChange(selectedPOStatus)">
            </kendo-dropdownlist>
          </div>
        </div>
        <div class="col col-auto">
          <div class="form-group row custFormrow ">
            <label for="staticEmail" class="col-form-label font-bold widthAuto minWidthAuto">PO To Date</label>
            <div class="custFields  custFields-lg">
              <div class="input-group">
                <kendo-datepicker [(value)]="selectedToDate" class="width-100" placeholder="mm/dd/yyyy" [format]="'MM/dd/yyyy'" (valueChange)=OnPOToChange(selectedToDate)></kendo-datepicker>
              </div>
            </div>
          </div>
        </div>
        <div class="col col-auto mr-auto">
          <div class="form-group row custFormrow armrk-btn">
            <button type="submit" class="btn btn-clearall-circle-red-bg" (click)="clearSearchForm()" [disabled]="setMasked"></button>
            <button type="submit" class="btn btn-arrow-right-circle-red-bg" (click)="loadGridData()" [disabled]="setMasked"></button>
          </div>
        </div>

        <div class="col col-auto mr-0 ml-auto">
          <div id="agglomerations2" class=" text-right col agglomerations iconTooltip iconTooltip-large armrk-btn pt-0 mt-4 mr-0 clearfix">
            <button title="Export to PDF"  class="icon_arm arm_pdf" id="moscow" [disabled]="gridDataList.data.length === 0" (click)="onExportPDF(grid)"></button>
            <button title="Export to Excel"  class="icon_arm arm_excel" id="moscow" [disabled]="gridDataList.data.length === 0" (click)="onExportExcel(grid)"></button>
           </div>
        </div>
  
      </form>
  
  
    </div>
    <div id="grid" class="clearfix responsiveTable">
      <!-- <div class="col-auto custFields custForm">
        <label class="font-bold mb-0" for="inlineFormInputGroup">Filtered Data</label>
      </div> -->
      <kendo-grid #grid="kendoGrid" [data]="gridDataList.data" [scrollable]="'scrollable'" [style.maxHeight.vh]="58" [style.minHeight.vh]="58"
      [sortable]="{allowUnsort:false}" [sort]="filterSort" (sortChange)="filterSortChange($event)">
        <kendo-grid-column title="#" width="40" class="text-center" [style.minWidth.px]="40" [style.maxWidth.px]="40">
          <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
            {{rowIndex + 1}}
          </ng-template>
        </kendo-grid-column>
  
        <kendo-grid-column field="PONbr" title="PO #" [width]="100">
          <ng-template kendoGridCellTemplate let-dataItem>
            <span class="link link-blue" (click)='post(dataItem.POHdrId)'>{{dataItem.PONbr}}</span>
          </ng-template>
        </kendo-grid-column>
  
        <kendo-grid-column field="OrderDate" title="PO Date" [width]="100">
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.OrderDate | datePipe}}
          </ng-template>
        </kendo-grid-column>
  
        <kendo-grid-column field="ItemNbr" title="Aramark Item" [width]="160">
        </kendo-grid-column>
  
        <kendo-grid-column field="Vendor" title="Vendor" [width]="160">
        </kendo-grid-column>
  
        <kendo-grid-column field="PickupLoc" title="Pickup Location" [width]="210" [style.minWidth.px]="210">
            <!-- <ng-template kendoGridHeaderTemplate>
                <div class="elepsis" style="min-width:170px;max-width:90%;" title="Pickup Location">Pickup Location</div>
              </ng-template> -->
            <ng-template kendoGridCellTemplate let-dataItem>
                <div class="elepsis" style="min-width:200px;max-width:200px;" title="{{dataItem.PickupLoc}}">  {{dataItem.PickupLoc}}</div>
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="SchedShipDate" title="Requested Date" [width]="120">
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.SchedShipDate | datePipe}}
          </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="ShipTo" title="Ship To" [width]="100">
        </kendo-grid-column>
        <kendo-grid-column  class="text-right"  field="Yards" title="Yards" [width]="100">
            <ng-template kendoGridCellTemplate let-dataItem>
                {{dataItem.Yards  | number}}
              </ng-template>
        </kendo-grid-column>
        <kendo-grid-column  class="text-right" field="UnitPrice" title="Price/Yard" [width]="100">
          <ng-template kendoGridCellTemplate let-dataItem>
              <span class="float-left">$</span>{{dataItem.UnitPrice  | number:'1.0-2'}}
          </ng-template>
        </kendo-grid-column>
        <kendo-grid-column  class="text-right" field="ExtendedValue" title="Extended Value" [width]="100">
          <ng-template kendoGridCellTemplate let-dataItem>
              <span class="float-left">$</span>{{dataItem.ExtendedValue | number:'1.0-2'}}
            </ng-template>
        </kendo-grid-column>
        <kendo-grid-column field="POStatus" title="PO Status" [width]="80">
        </kendo-grid-column>
        <kendo-grid-column field="ApprovedBy" title="Approved By" [width]="80">
        </kendo-grid-column>
        <kendo-grid-column field="VendorConfirmed" title="Vendor Confirmed" [width]="140">
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.VendorConfirmed | datePipe}}
          </ng-template>
        </kendo-grid-column>

        <kendo-grid-pdf fileName="po_search_results.pdf" [repeatHeaders]="true">
          <kendo-grid-pdf-margin top="1cm" left="1cm" right="1cm" bottom="2cm"></kendo-grid-pdf-margin>
          <ng-template kendoGridPDFTemplate let-pageNum="pageNum" let-totalPages="totalPages">
            <div class="page-template">
              <div class="header">
                <div style="float: right">Page {{ pageNum }} of {{ totalPages }}</div>
              </div>
              <div class="footer">
                Page {{ pageNum }} of {{ totalPages }}
              </div>
            </div>
          </ng-template>
          <kendo-grid-column field="PONbr" title="PO #">
          </kendo-grid-column>
          <kendo-grid-column field="OrderDate" title="PO Date">
          </kendo-grid-column>
          <kendo-grid-column field="ItemNbr" title="Aramark Item">
          </kendo-grid-column>
          <kendo-grid-column field="Vendor" title="Vendor">
          </kendo-grid-column>
          <kendo-grid-column field="PickupLoc" title="Pickup Location">
          </kendo-grid-column>
          <kendo-grid-column field="SchedShipDate" title="Requested Date">
          </kendo-grid-column>
          <kendo-grid-column field="ShipTo" title="Ship To">
          </kendo-grid-column>
          <kendo-grid-column field="Yards" title="Yards">
          </kendo-grid-column>
          <kendo-grid-column field="UnitPrice" title="Price/Yard">
          </kendo-grid-column>
          <kendo-grid-column field="ExtendedValue" title="Extended Value">
          </kendo-grid-column>
          <kendo-grid-column field="POStatus" title="PO Status">
          </kendo-grid-column>
          <kendo-grid-column field="ApprovedBy" title="Approved By">
          </kendo-grid-column>
          <kendo-grid-column field="VendorConfirmed" title="Vendor Confirmed">
          </kendo-grid-column>
        </kendo-grid-pdf>

        <kendo-grid-excel fileName="po_search_results.xlsx">
          
          <kendo-excelexport-column field="PONbr" title="PO #">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="OrderDate" title="PO Date">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="ItemNbr" title="Aramark Item">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="Vendor" title="Vendor">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="PickupLoc" title="Pickup Location">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="SchedShipDate" title="Requested Date">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="ShipTo" title="Ship To">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="Yards" title="Yards">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="UnitPrice" title="Price/Yard">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="ExtendedValue" title="Extended Value">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="POStatus" title="PO Status">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="ApprovedBy" title="Approved By">
          </kendo-excelexport-column>
          <kendo-excelexport-column field="VendorConfirmed" title="Vendor Confirmed">
          </kendo-excelexport-column>

        </kendo-grid-excel>
      </kendo-grid>
    </div>
  